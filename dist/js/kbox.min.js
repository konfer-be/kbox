"use strict";if(void 0===window.kbox){const t=function(){let t={LANDSCAPE:"LANDSCAPE",PORTRAIT:"PORTRAIT"},u=null,d=null,c=null,n=null,E=null,f=null,w={},h=!1,b="",A={},p=0,C={width:.925*window.innerWidth,height:.925*window.innerHeight,orientation:t.LANDSCAPE},k={lang:"fr",animationSpeed:750,keyboard:!0,titles:!0,afterOpening:function(t){},afterTransition:function(t){},afterClosing:function(t){}};const S=function(u){let d=1;u.width<u.height?t.PORTRAIT:t.LANDSCAPE;if(u.width>C.width&&u.height>C.height){let t=parseFloat(C.width/u.width*.8),c=parseFloat(C.height/u.height*.8);d=t-c>=0?t:c}else u.width>C.width?d=parseFloat(C.width/u.width*.8):u.height>C.height&&(d=parseFloat(C.height/u.height*.8));return u.width=u.width*d.toFixed(2),u.height=u.height*d.toFixed(2),u},T=function(t){let u=B.gallery(t),d=Object.keys(A).length;void 0===A[u]?A[u]={id:d,name:u,pictures:[],occurrences:0}:A[u].occurrences++,A[u].pictures[A[u].occurrences]=function(t){let u=new Image;return u.onload=function(){S(u)},u.src=t.href,u.alt=t.firstElementChild.alt,u}(t)},I=function(t){t.preventDefault();let u=t.target,d=u.parentElement;h=!0,b=B.gallery(d),A[b].pictures.forEach(function(t,d){u.src===t.src&&(p=d)}),window.dispatchEvent(F.custom.modal.contextualized)},L=function(){let t=c.getElementsByTagName("img");if(!t.length)throw new Error("Img tag not found");t[0].src=A[b].pictures[p].src,t[0].alt=A[b].pictures[p].alt,t[0].height=A[b].pictures[p].height,t[0].width=A[b].pictures[p].width,n.textContent=b,E.textContent=w.position.replace(/{{current}}/i,(p+1).toString()).replace(/{{total}}/i,A[b].pictures.length.toString()),f.textContent=A[b].pictures[p].alt},N=function(t){t.preventDefault(),L(),Velocity(document.getElementById("kbox-overlay"),{opacity:1,display:"block",duration:200}),Velocity(c,{top:B.position().y,left:B.position().x,opacity:1,display:"block",duration:k.animationSpeed},function(){window.dispatchEvent(F.custom.modal.opened)})},P=function(t){t.preventDefault(),p=0,h=!1,b="",Velocity(d,{display:"none",opacity:0,duration:250}),Velocity(c,{display:"none",opacity:0,duration:250},function(){window.dispatchEvent(F.custom.modal.closed)})},R=function(){Velocity(c,{display:"none",opacity:0,duration:250},function(){L(),Velocity(c,{top:B.position().y,left:B.position().x,opacity:1,display:"block",duration:k.animationSpeed},function(){window.dispatchEvent(F.custom.modal.transitioned)})})},v=function(t){return new Promise(function(u,d){!function(t,u){let d=new XMLHttpRequest;d.overrideMimeType("application/json"),d.open("GET",t,!0),d.onreadystatechange=function(){4===d.readyState&&200===d.status?u({status:200,json:d.responseText}):4===d.readyState&&200!==d.status&&u({status:d.status,json:{}})},d.send(null)}("./locales/"+t+".json",function(t){200===t.status?u(JSON.parse(t.json)):d(JSON.parse(t.json))})})},B={gallery:function(t){return void 0!==t.getAttribute("data-kbox")?t.getAttribute("data-kbox"):"isolated"},position:function(){return{x:parseFloat((window.innerWidth-A[b].pictures[p].width)/2-10),y:parseFloat((window.innerHeight-A[b].pictures[p].height)/2-10)}}},F={custom:{modal:{contextualized:new Event("modal.contextualized"),pointed:new Event("modal.pointed"),opened:new Event("modal.opened"),transitioned:new Event("modal.transitioned"),closed:new Event("modal.closed"),exited:new Event("modal.exited")}},init:function(t){window.addEventListener("modal.contextualized",N),window.addEventListener("modal.pointed",R),window.addEventListener("modal.opened",k.afterOpening),window.addEventListener("modal.transitioned",k.afterTransition),window.addEventListener("modal.closed",k.afterClosing),window.addEventListener("modal.exited",P),F.opening(t),k.keyboard&&F.keyboard(),F.closing(),F.navigation()},opening:function(t){t.forEach(function(t){t.addEventListener("click",I,!1)})},closing:function(){let t=document.querySelectorAll(".kbox-close--trigger");if(!t.length)return!1;t.forEach(function(t){t.addEventListener("click",P,!1)})},keyboard:function(){u.addEventListener("keyup",function(t){if(t.preventDefault(),!0===h){switch(t.keyCode){case 37:case 100:p-1<0?p=A[b].pictures.length-1:p--,window.dispatchEvent(F.custom.modal.pointed);break;case 39:case 102:p+1>A[b].pictures.length-1?p=0:p++,window.dispatchEvent(F.custom.modal.pointed);break;case 27:window.dispatchEvent(F.custom.modal.exited)}}},!1)},navigation:function(){let t=document.querySelectorAll(".kbox-nav");if(!t.length)return!1;t.forEach(function(t){t.addEventListener("click",function(t){t.preventDefault(),"kbox-nav--prev"===t.target.id?p-1<0?p=A[b].pictures.length-1:p--:p+1>A[b].pictures.length-1?p=0:p++,window.dispatchEvent(F.custom.modal.pointed)},!1)})}},o={overlay:function(){let t=document.createElement("div");return t.setAttribute("id","kbox-overlay"),t.setAttribute("class","kbox-close--trigger"),t},navigation:function(t){let u=document.createElement("div");u.setAttribute("id",t),u.setAttribute("class","kbox-nav"),k.titles&&u.setAttribute("title","kbox-nav--prev"===t?w.previous:w.next);let d=document.createElement("span");return d.setAttribute("class","kbox-nav--prev"===t?"hc hc-arrow-round-back":"hc hc-arrow-round-forward"),u.appendChild(d),u},modal:function(){let t=document.createElement("div");t.setAttribute("id","kbox-modal");let u=document.createElement("div");u.setAttribute("id","kbox-close"),u.setAttribute("class","kbox-close--trigger"),k.titles&&u.setAttribute("title",w.close);let d=document.createElement("i");d.setAttribute("class","hc hc-close"),u.appendChild(d);let n=new Image;n.setAttribute("id","kbox-image");let E=document.createElement("div");E.setAttribute("id","kbox-info");let f=document.createElement("div");f.setAttribute("id","kbox-info--context");let h=document.createElement("span");h.setAttribute("id","kbox-info--theme");let b=document.createElement("span");b.setAttribute("id","kbox-info--quantities");let A=document.createElement("div");A.setAttribute("id","kbox-info--alt"),f.appendChild(h),f.appendChild(b),E.appendChild(f),E.appendChild(A);let p=o.navigation("kbox-nav--prev"),C=o.navigation("kbox-nav--next");return t.appendChild(p),t.appendChild(n),t.appendChild(C),t.appendChild(E),t.appendChild(u),c=t,t}},y={init:async function(h){try{if(k=Object.assign(k,h),w=await v(k.lang),window.innerWidth<window.innerHeight&&(C.orientation=t.PORTRAIT),!(u=document.getElementsByTagName("body")[0]))return!1;let b=document.querySelectorAll(".kbox"),A=b.length;if(!b.length)return!1;for(let t=0;t<=A-1;t++)k.titles&&(b[t].title=w.display),T(b[t]);u.appendChild(o.overlay()),u.appendChild(o.modal()),d=document.getElementById("kbox-overlay"),c=document.getElementById("kbox-modal"),n=document.getElementById("kbox-info--theme"),f=document.getElementById("kbox-info--alt"),E=document.getElementById("kbox-info--quantities"),F.init(b)}catch(t){alert(t.message)}}};return y};window.kbox=t().init}else console.log("Namespace kbox already exists !");
//# sourceMappingURL=kbox.min.js.map
