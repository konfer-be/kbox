"use strict";if(void 0===window.kbox){const t=function(){let t={LANDSCAPE:"LANDSCAPE",PORTRAIT:"PORTRAIT"},d={},n=!1,u="",c={},h=0,o={width:.925*window.innerWidth,height:.925*window.innerHeight,orientation:t.LANDSCAPE},b={lang:"fr",animationSpeed:750,keyboard:!0,titles:!0,afterOpening:function(t){},afterTransition:function(t){},afterClosing:function(t){}};const f=function(d){let n=1,u=o.orientation===t.PORTRAIT?.9:.8;if(d.width>o.width&&d.height>o.height){let t=parseFloat(o.width/d.width*u),c=parseFloat(o.height/d.height*u);n=t-c<=0?t:c}else d.width>o.width?n=parseFloat(o.width/d.width*u):d.height>o.height&&(n=parseFloat(o.height/d.height*u));return d.width=d.width*n.toFixed(2),d.height=d.height*n.toFixed(2),d},E=function(t){let n=k.gallery(t),u=Object.keys(c).length;void 0===c[n]?c[n]={id:u,name:n,pictures:[],occurrences:0}:c[n].occurrences++,c[n].pictures[c[n].occurrences]=function(t){let n=new Image;return n.onload=function(){f(n)},n.src=t.href,n.alt=t.firstElementChild.alt,0===n.height&&(n.src="https://via.placeholder.com/350",n.alt=d.notFound),n}(t)},w=function(t){t.preventDefault();let d=t.target,o=d.parentElement;n=!0,u=k.gallery(o),c[u].pictures.forEach(function(t,n){d.src===t.src&&(h=n)}),window.dispatchEvent(L.custom.modal.contextualized)},A=function(){let t=S.modal.getElementsByTagName("img");if(!t.length)throw new Error("Img tag not found");t[0].src=c[u].pictures[h].src,t[0].alt=c[u].pictures[h].alt,t[0].height=c[u].pictures[h].height,t[0].width=c[u].pictures[h].width,S.theme.textContent=u,S.quantities.textContent=d.position.replace(/{{current}}/i,(h+1).toString()).replace(/{{total}}/i,c[u].pictures.length.toString()),S.alt.textContent=c[u].pictures[h].alt},p=function(t){t.preventDefault(),A(),S.overlay.classList.add("opened"),S.modal.classList.add("opened")},C=function(t){t.preventDefault(),h=0,n=!1,u="",S.overlay.classList.remove("opened"),Velocity(S.modal,{display:"none",opacity:0,duration:250},function(){window.dispatchEvent(L.custom.modal.closed)})},T=function(){Velocity(S.modal,{display:"none",opacity:0,duration:250},function(){A(),Velocity(S.modal,{top:k.position().y,left:k.position().x,opacity:1,display:"block",duration:b.animationSpeed},function(){window.dispatchEvent(L.custom.modal.transitioned)})})},v=function(t){return new Promise(function(d,n){!function(t,d){let n=new XMLHttpRequest;n.overrideMimeType("application/json"),n.open("GET",t,!0),n.onreadystatechange=function(){4===n.readyState&&200===n.status?d({status:200,json:n.responseText}):4===n.readyState&&200!==n.status&&d({status:n.status,json:{}})},n.send(null)}("./locales/"+t+".json",function(t){200===t.status?d(JSON.parse(t.json)):n(JSON.parse(t.json))})})},y={increase:function(){h+1>c[u].pictures.length-1?h=0:h++,window.dispatchEvent(L.custom.modal.pointed)},decrease:function(){h-1<0?h=c[u].pictures.length-1:h--,window.dispatchEvent(L.custom.modal.pointed)}},k={gallery:function(t){return void 0!==t.getAttribute("data-kbox")?t.getAttribute("data-kbox"):"isolated"},position:function(){return{x:parseFloat((window.innerWidth-c[u].pictures[h].width)/2-10),y:parseFloat((window.innerHeight-c[u].pictures[h].height)/2-10)}}},L={custom:{modal:{contextualized:new Event("modal.contextualized"),pointed:new Event("modal.pointed"),opened:new Event("modal.opened"),transitioned:new Event("modal.transitioned"),closed:new Event("modal.closed"),exited:new Event("modal.exited")}},init:function(t){window.addEventListener("modal.contextualized",p),window.addEventListener("modal.pointed",T),window.addEventListener("modal.opened",b.afterOpening),window.addEventListener("modal.transitioned",b.afterTransition),window.addEventListener("modal.closed",b.afterClosing),window.addEventListener("modal.exited",C),b.keyboard&&L.keyboard(),L.opening(t),L.closing(),"ontouchstart"in document.documentElement?L.touch():L.navigation()},opening:function(t){t.forEach(function(t){t.addEventListener("click",w,!1)})},closing:function(){let t=document.querySelectorAll(".kbox-close--trigger");if(!t.length)return!1;t.forEach(function(t){t.addEventListener("click",C,!1)})},keyboard:function(){S.body.addEventListener("keyup",function(t){if(t.preventDefault(),!0===n){switch(t.keyCode){case 37:case 100:y.decrease();break;case 39:case 102:y.increase();break;case 27:window.dispatchEvent(L.custom.modal.exited)}}},!1)},navigation:function(){let t=document.querySelectorAll(".kbox-nav");if(!t.length)return!1;t.forEach(function(t){t.addEventListener("click",function(t){t.preventDefault(),"kbox-nav--prev"===t.target.id?y.decrease():y.increase()},!1)})},touch:function(){let t=0,d=0;S.modal.addEventListener("touchstart",function(n){n.changedTouches&&(t=n.changedTouches[0].screenX),d=n.changedTouches[0].screenY},!1),S.modal.addEventListener("touchend",function(d){d.changedTouches&&d.changedTouches[0].screenX+20>t+20?y.decrease():d.changedTouches&&d.changedTouches[0].screenX+20<t+20&&y.increase()},!1)}},S={body:null,overlay:null,modal:null,theme:null,quantities:null,alt:null,init:function(){S.body.appendChild(S.build.overlay()),S.body.appendChild(S.build.modal()),S.overlay=document.getElementById("kbox-overlay"),S.modal=document.getElementById("kbox-modal"),S.theme=document.getElementById("kbox-info--theme"),S.alt=document.getElementById("kbox-info--alt"),S.quantities=document.getElementById("kbox-info--quantities")},build:{overlay:function(){let t=document.createElement("div");return t.setAttribute("id","kbox-overlay"),t.setAttribute("class","kbox-close--trigger"),t},navigation:function(t){let n=document.createElement("div");n.setAttribute("id",t),n.setAttribute("class","kbox-nav"),b.titles&&n.setAttribute("title","kbox-nav--prev"===t?d.previous:d.next);let u=document.createElement("span");return u.setAttribute("class","kbox-nav--prev"===t?"hc hc-arrow-round-back":"hc hc-arrow-round-forward"),n.appendChild(u),n},modal:function(){let t=document.createElement("div");t.setAttribute("id","kbox-modal");let n=document.createElement("div");n.setAttribute("id","kbox-close"),n.setAttribute("class","kbox-close--trigger"),b.titles&&n.setAttribute("title",d.close);let u=document.createElement("i");u.setAttribute("class","hc hc-close"),n.appendChild(u);let c=new Image;c.setAttribute("id","kbox-image");let h=document.createElement("div");h.setAttribute("id","kbox-info");let o=document.createElement("div");o.setAttribute("id","kbox-info--context");let f=document.createElement("span");f.setAttribute("id","kbox-info--theme");let E=document.createElement("span");E.setAttribute("id","kbox-info--quantities");let w=document.createElement("div");w.setAttribute("id","kbox-info--alt"),o.appendChild(f),o.appendChild(E),h.appendChild(o),h.appendChild(w);let A=S.build.navigation("kbox-nav--prev"),p=S.build.navigation("kbox-nav--next");return t.appendChild(A),t.appendChild(c),t.appendChild(p),t.appendChild(h),t.appendChild(n),S.modal=t,t}}},I={init:async function(n){try{if(b=Object.assign(b,n),d=await v(b.lang),window.innerWidth<window.innerHeight&&(o.orientation=t.PORTRAIT),S.body=document.getElementsByTagName("body")[0],!S.body)return!1;let u=document.querySelectorAll(".kbox"),c=u.length;if(!u.length)return!1;for(let t=0;t<=c-1;t++)b.titles&&(u[t].title=d.display),E(u[t]);S.init(),L.init(u)}catch(t){alert(t.message)}}};return I};window.kbox=t().init}else console.log("Namespace kbox already exists !");
//# sourceMappingURL=kbox.min.js.map
