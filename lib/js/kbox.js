"use strict";if(void 0===window.kbox){const u=function(){let u=null,t=null,c={},E=!1,b="",d={},A=0,k=.925*window.innerWidth,C=.925*window.innerHeight,n={lang:"fr",animationSpeed:750,keyboard:!0,titles:!0,afterOpening:function(u){},afterTransition:function(u){},afterClosing:function(u){}};const v=function(u){let t={height:1,width:1};if(u.width>k&&u.height>C){let c=u.width-k,E=u.height-C,b=c-E>=0?c:E;t={height:1-parseFloat("0."+b),width:1-parseFloat("0."+b)}}else if(u.width>k||u.height>C){let c=u.width>k?u.width-k:u.height-C;t={height:1-parseFloat("0."+c),width:1-parseFloat("0."+c)}}return u.width=u.width*t.width,u.height=u.height*t.height,u},B=function(u){let t=V.gallery(u),c=Object.keys(d).length;void 0===d[t]?d[t]={id:c,name:t,pictures:[],occurrences:0}:d[t].occurrences++,d[t].pictures[d[t].occurrences]=function(u){let t=new Image;return t.onload=function(){v(t)},t.src=u.href,t.alt=u.firstElementChild.alt,t}(u)},I=function(u){u.preventDefault();let t=u.target,c=t.parentElement;E=!0,b=V.gallery(c),d[b].pictures.forEach(function(u,c){t.src===u.src&&(A=c)}),window.dispatchEvent(L.custom.modal.contextualized)},S=function(){let u=t.getElementsByTagName("img"),E=document.getElementById("kbox-info--theme"),k=document.getElementById("kbox-info--alt"),C=document.getElementById("kbox-info--quantities");if(!u.length)throw new Error("Img tag not found");u[0].src=d[b].pictures[A].src,u[0].alt=d[b].pictures[A].alt,u[0].height=d[b].pictures[A].height,u[0].width=d[b].pictures[A].width,E.textContent=b,C.textContent=c.position.replace(/{{current}}/i,A+1).replace(/{{total}}/i,d[b].pictures.length),k.textContent=d[b].pictures[A].alt},p=function(u){u.preventDefault(),S(),Velocity(document.getElementById("kbox-overlay"),{opacity:1,display:"block",duration:200}),Velocity(t,{top:(C-d[b].pictures[A].height)/2,left:(k-d[b].pictures[A].width)/2,opacity:1,display:"block",duration:n.animationSpeed},function(){window.dispatchEvent(L.custom.modal.opened)})},T=function(u){u.preventDefault(),A=0,E=!1,b="";let t=document.getElementById("kbox-overlay"),c=document.getElementById("kbox-modal");Velocity(t,{display:"none",opacity:0,duration:250}),Velocity(c,{display:"none",opacity:0,duration:250},function(){window.dispatchEvent(L.custom.modal.closed)})},w=function(){let u=document.getElementById("kbox-modal");Velocity(u,{display:"none",opacity:0,duration:250},function(){S(),Velocity(u,{top:(C-d[b].pictures[A].height)/2,left:(k-d[b].pictures[A].width)/2,opacity:1,display:"block",duration:n.animationSpeed},function(){window.dispatchEvent(L.custom.modal.transitioned)})})},N=function(u){return new Promise(function(t,c){!function(u,t){let c=new XMLHttpRequest;c.overrideMimeType("application/json"),c.open("GET",u,!0),c.onreadystatechange=function(){4===c.readyState&&200===c.status?t({status:200,json:c.responseText}):4===c.readyState&&200!==c.status&&t({status:c.status,json:{}})},c.send(null)}("./locales/"+u+".json",function(u){200===u.status?t(JSON.parse(u.json)):c(JSON.parse(u.json))})})},V={gallery:function(u){return void 0!==u.getAttribute("data-kbox")?u.getAttribute("data-kbox"):"isolated"}},L={custom:{modal:{contextualized:new Event("modal.contextualized"),opened:new Event("modal.opened"),transitioned:new Event("modal.transitioned"),closed:new Event("modal.closed")}},init:function(u){window.addEventListener("modal.contextualized",p),window.addEventListener("modal.opened",n.afterOpening),window.addEventListener("modal.transitioned",n.afterTransition),window.addEventListener("modal.closed",n.afterClosing),L.opening(u),n.keyboard&&L.keyboard(),L.closing(),L.navigation()},opening:function(u){u.forEach(function(u){u.addEventListener("click",I,!1)})},closing:function(){let u=document.querySelectorAll(".kbox-close--trigger");if(!u.length)return!1;u.forEach(function(u){u.addEventListener("click",T,!1)})},keyboard:function(){let u=document.getElementsByTagName("body");if(!u.length)return!1;u[0].addEventListener("keyup",function(u){if(u.preventDefault(),!0===E){switch(u.keyCode){case 37:case 100:A-1<0?A=d[b].pictures.length-1:A--,w();break;case 39:case 102:A+1>d[b].pictures.length-1?A=0:A++,w();break;case 27:T()}}},!1)},navigation:function(){let u=document.querySelectorAll(".kbox-nav");if(!u.length)return!1;u.forEach(function(u){u.addEventListener("click",function(u){(u=u||window.event).preventDefault(),"kbox-nav-prev"===u.target.id?A-1<0?A=d[b].pictures.length-1:A--:A+1>d[b].pictures.length-1?A=0:A++,w()},!1)})}},F={overlay:function(){let u=document.createElement("div");return u.setAttribute("id","kbox-overlay"),u.setAttribute("class","kbox-close--trigger"),u},navigation:function(u){let t=document.createElement("div");t.setAttribute("id",u),t.setAttribute("class","kbox-nav"),n.titles&&t.setAttribute("title","kbox-nav--prev"===u?c.previous:c.next);let E=document.createElement("span");return E.setAttribute("class","kbox-nav--prev"===u?"hc hc-arrow-round-back":"hc hc-arrow-round-forward"),t.appendChild(E),t},modal:function(){let u=document.createElement("div");u.setAttribute("id","kbox-modal");let E=document.createElement("div");E.setAttribute("id","kbox-close"),E.setAttribute("class","kbox-close--trigger"),n.titles&&E.setAttribute("title",c.close);let b=document.createElement("i");b.setAttribute("class","hc hc-close"),E.appendChild(b);let d=new Image;d.setAttribute("id","kbox-image");let A=document.createElement("div");A.setAttribute("id","kbox-info");let k=document.createElement("div");k.setAttribute("id","kbox-info--context");let C=document.createElement("span");C.setAttribute("id","kbox-info--theme");let v=document.createElement("span");v.setAttribute("id","kbox-info--quantities");let B=document.createElement("div");B.setAttribute("id","kbox-info--alt"),k.appendChild(C),k.appendChild(v),A.appendChild(k),A.appendChild(B);let I=F.navigation("kbox-nav--prev"),S=F.navigation("kbox-nav--next");return u.appendChild(I),u.appendChild(d),u.appendChild(S),u.appendChild(A),u.appendChild(E),t=u,u}},j={init:async function(t){if(n=t||n,c=await N(n.lang),!(u=document.getElementsByTagName("body")[0]))throw new Error("Body tag not found");let E=document.querySelectorAll(".kbox"),b=E.length;if(!E.length)return!1;for(let u=0;u<=b-1;u++)n.titles&&(E[u].title=c.display),B(E[u]);u.appendChild(F.overlay()),u.appendChild(F.modal()),L.init(E)}};return j};window.kbox=u().init}else console.log("Namespace kbox already exists !");