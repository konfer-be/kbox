"use strict";if(void 0===window.kbox){const t=function(){let t={LANDSCAPE:"LANDSCAPE",PORTRAIT:"PORTRAIT"},d={},u=!1,c="",n={},b=0,o={width:.925*window.innerWidth,height:.925*window.innerHeight,orientation:t.LANDSCAPE},E={lang:"fr",animationSpeed:750,keyboard:!0,titles:!0,afterOpening:function(t){},afterTransition:function(t){},afterClosing:function(t){}};const h=function(d){let u=1;d.width<d.height?t.PORTRAIT:t.LANDSCAPE;if(d.width>o.width&&d.height>o.height){let t=parseFloat(o.width/d.width*.8),c=parseFloat(o.height/d.height*.8);u=t-c>=0?t:c,console.log("case1")}else d.width>o.width?u=parseFloat(o.width/d.width*.8):d.height>o.height&&(u=parseFloat(o.height/d.height*.8));return d.width=d.width*u.toFixed(2),d.height=d.height*u.toFixed(2),d},f=function(t){let d=v.gallery(t),u=Object.keys(n).length;void 0===n[d]?n[d]={id:u,name:d,pictures:[],occurrences:0}:n[d].occurrences++,n[d].pictures[n[d].occurrences]=function(t){let d=new Image;return d.onload=function(){h(d)},d.src=t.href,d.alt=t.firstElementChild.alt,d}(t)},w=function(t){t.preventDefault();let d=t.target,o=d.parentElement;u=!0,c=v.gallery(o),n[c].pictures.forEach(function(t,u){d.src===t.src&&(b=u)}),window.dispatchEvent(S.custom.modal.contextualized)},A=function(){let t=T.modal.getElementsByTagName("img");if(!t.length)throw new Error("Img tag not found");t[0].src=n[c].pictures[b].src,t[0].alt=n[c].pictures[b].alt,t[0].height=n[c].pictures[b].height,t[0].width=n[c].pictures[b].width,T.theme.textContent=c,T.quantities.textContent=d.position.replace(/{{current}}/i,(b+1).toString()).replace(/{{total}}/i,n[c].pictures.length.toString()),T.alt.textContent=n[c].pictures[b].alt},y=function(t){t.preventDefault(),A(),Velocity(T.overlay,{opacity:1,display:"block",duration:200}),Velocity(T.modal,{top:v.position().y,left:v.position().x,opacity:1,display:"block",duration:E.animationSpeed},function(){window.dispatchEvent(S.custom.modal.opened)})},p=function(t){t.preventDefault(),b=0,u=!1,c="",Velocity(T.overlay,{display:"none",opacity:0,duration:250}),Velocity(T.modal,{display:"none",opacity:0,duration:250},function(){window.dispatchEvent(S.custom.modal.closed)})},C=function(){Velocity(T.modal,{display:"none",opacity:0,duration:250},function(){A(),Velocity(T.modal,{top:v.position().y,left:v.position().x,opacity:1,display:"block",duration:E.animationSpeed},function(){window.dispatchEvent(S.custom.modal.transitioned)})})},k=function(t){return new Promise(function(d,u){!function(t,d){let u=new XMLHttpRequest;u.overrideMimeType("application/json"),u.open("GET",t,!0),u.onreadystatechange=function(){4===u.readyState&&200===u.status?d({status:200,json:u.responseText}):4===u.readyState&&200!==u.status&&d({status:u.status,json:{}})},u.send(null)}("./locales/"+t+".json",function(t){200===t.status?d(JSON.parse(t.json)):u(JSON.parse(t.json))})})},v={gallery:function(t){return void 0!==t.getAttribute("data-kbox")?t.getAttribute("data-kbox"):"isolated"},position:function(){return{x:parseFloat((window.innerWidth-n[c].pictures[b].width)/2-10),y:parseFloat((window.innerHeight-n[c].pictures[b].height)/2-10)}}},S={custom:{modal:{contextualized:new Event("modal.contextualized"),pointed:new Event("modal.pointed"),opened:new Event("modal.opened"),transitioned:new Event("modal.transitioned"),closed:new Event("modal.closed"),exited:new Event("modal.exited")}},init:function(t){window.addEventListener("modal.contextualized",y),window.addEventListener("modal.pointed",C),window.addEventListener("modal.opened",E.afterOpening),window.addEventListener("modal.transitioned",E.afterTransition),window.addEventListener("modal.closed",E.afterClosing),window.addEventListener("modal.exited",p),S.opening(t),E.keyboard&&S.keyboard(),S.closing(),S.navigation()},opening:function(t){t.forEach(function(t){t.addEventListener("click",w,!1)})},closing:function(){let t=document.querySelectorAll(".kbox-close--trigger");if(!t.length)return!1;t.forEach(function(t){t.addEventListener("click",p,!1)})},keyboard:function(){T.body.addEventListener("keyup",function(t){if(t.preventDefault(),!0===u){switch(t.keyCode){case 37:case 100:b-1<0?b=n[c].pictures.length-1:b--,window.dispatchEvent(S.custom.modal.pointed);break;case 39:case 102:b+1>n[c].pictures.length-1?b=0:b++,window.dispatchEvent(S.custom.modal.pointed);break;case 27:window.dispatchEvent(S.custom.modal.exited)}}},!1)},navigation:function(){let t=document.querySelectorAll(".kbox-nav");if(!t.length)return!1;t.forEach(function(t){t.addEventListener("click",function(t){t.preventDefault(),"kbox-nav--prev"===t.target.id?b-1<0?b=n[c].pictures.length-1:b--:b+1>n[c].pictures.length-1?b=0:b++,window.dispatchEvent(S.custom.modal.pointed)},!1)})}},T={body:null,overlay:null,modal:null,theme:null,quantities:null,alt:null,build:{overlay:function(){let t=document.createElement("div");return t.setAttribute("id","kbox-overlay"),t.setAttribute("class","kbox-close--trigger"),t},navigation:function(t){let u=document.createElement("div");u.setAttribute("id",t),u.setAttribute("class","kbox-nav"),E.titles&&u.setAttribute("title","kbox-nav--prev"===t?d.previous:d.next);let c=document.createElement("span");return c.setAttribute("class","kbox-nav--prev"===t?"hc hc-arrow-round-back":"hc hc-arrow-round-forward"),u.appendChild(c),u},modal:function(){let t=document.createElement("div");t.setAttribute("id","kbox-modal");let u=document.createElement("div");u.setAttribute("id","kbox-close"),u.setAttribute("class","kbox-close--trigger"),E.titles&&u.setAttribute("title",d.close);let c=document.createElement("i");c.setAttribute("class","hc hc-close"),u.appendChild(c);let n=new Image;n.setAttribute("id","kbox-image");let b=document.createElement("div");b.setAttribute("id","kbox-info");let o=document.createElement("div");o.setAttribute("id","kbox-info--context");let h=document.createElement("span");h.setAttribute("id","kbox-info--theme");let f=document.createElement("span");f.setAttribute("id","kbox-info--quantities");let w=document.createElement("div");w.setAttribute("id","kbox-info--alt"),o.appendChild(h),o.appendChild(f),b.appendChild(o),b.appendChild(w);let A=T.build.navigation("kbox-nav--prev"),y=T.build.navigation("kbox-nav--next");return t.appendChild(A),t.appendChild(n),t.appendChild(y),t.appendChild(b),t.appendChild(u),T.modal=t,t}},init:function(){T.body.appendChild(T.build.overlay()),T.body.appendChild(T.build.modal()),T.overlay=document.getElementById("kbox-overlay"),T.modal=document.getElementById("kbox-modal"),T.theme=document.getElementById("kbox-info--theme"),T.alt=document.getElementById("kbox-info--alt"),T.quantities=document.getElementById("kbox-info--quantities")}},a={init:async function(u){try{if(E=Object.assign(E,u),d=await k(E.lang),window.innerWidth<window.innerHeight&&(o.orientation=t.PORTRAIT),T.body=document.getElementsByTagName("body")[0],!T.body)return!1;let c=document.querySelectorAll(".kbox"),n=c.length;if(!c.length)return!1;for(let t=0;t<=n-1;t++)E.titles&&(c[t].title=d.display),f(c[t]);T.init(),S.init(c)}catch(t){alert(t.message)}}};return a};window.kbox=t().init}else console.log("Namespace kbox already exists !");
//# sourceMappingURL=kbox.min.js.map
