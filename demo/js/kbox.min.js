"use strict";if(void 0===window.kbox){const t=function(){let t={LANDSCAPE:"LANDSCAPE",PORTRAIT:"PORTRAIT"},d={},n=!1,u="",c={},o=0,h={width:.925*window.innerWidth,height:.925*window.innerHeight,orientation:t.LANDSCAPE},b={lang:"fr",animationSpeed:750,keyboard:!0,titles:!0,afterOpening:function(t){},afterTransition:function(t){},afterClosing:function(t){}};const f=function(d){let n=1,u=h.orientation===t.PORTRAIT?.9:.8;if(d.width>h.width&&d.height>h.height){let t=parseFloat(h.width/d.width*u),c=parseFloat(h.height/d.height*u);n=t-c<=0?t:c}else d.width>h.width?n=parseFloat(h.width/d.width*u):d.height>h.height&&(n=parseFloat(h.height/d.height*u));return d.width=d.width*n.toFixed(2),d.height=d.height*n.toFixed(2),d},E=function(t){let d=k.gallery(t),n=Object.keys(c).length;void 0===c[d]?c[d]={id:n,name:d,pictures:[],occurrences:0}:c[d].occurrences++,c[d].pictures[c[d].occurrences]=function(t){let d=new Image;return d.onload=function(){f(d)},d.src=t.href,d.alt=t.firstElementChild.alt,d}(t)},w=function(t){t.preventDefault();let d=t.target,h=d.parentElement;n=!0,u=k.gallery(h),c[u].pictures.forEach(function(t,n){d.src===t.src&&(o=n)}),window.dispatchEvent(v.custom.modal.contextualized)},p=function(){let t=S.modal.getElementsByTagName("img");if(!t.length)throw new Error("Img tag not found");t[0].src=c[u].pictures[o].src,t[0].alt=c[u].pictures[o].alt,t[0].height=c[u].pictures[o].height,t[0].width=c[u].pictures[o].width,S.theme.textContent=u,S.quantities.textContent=d.position.replace(/{{current}}/i,(o+1).toString()).replace(/{{total}}/i,c[u].pictures.length.toString()),S.alt.textContent=c[u].pictures[o].alt},A=function(t){t.preventDefault(),p(),Velocity(S.overlay,{opacity:1,display:"block",duration:200}),Velocity(S.modal,{top:k.position().y,left:k.position().x,opacity:1,display:"block",duration:b.animationSpeed},function(){window.dispatchEvent(v.custom.modal.opened)})},y=function(t){t.preventDefault(),o=0,n=!1,u="",Velocity(S.overlay,{display:"none",opacity:0,duration:250}),Velocity(S.modal,{display:"none",opacity:0,duration:250},function(){window.dispatchEvent(v.custom.modal.closed)})},C=function(){Velocity(S.modal,{display:"none",opacity:0,duration:250},function(){p(),Velocity(S.modal,{top:k.position().y,left:k.position().x,opacity:1,display:"block",duration:b.animationSpeed},function(){window.dispatchEvent(v.custom.modal.transitioned)})})},T=function(t){return new Promise(function(d,n){!function(t,d){let n=new XMLHttpRequest;n.overrideMimeType("application/json"),n.open("GET",t,!0),n.onreadystatechange=function(){4===n.readyState&&200===n.status?d({status:200,json:n.responseText}):4===n.readyState&&200!==n.status&&d({status:n.status,json:{}})},n.send(null)}("./locales/"+t+".json",function(t){200===t.status?d(JSON.parse(t.json)):n(JSON.parse(t.json))})})},a={increase:function(){o+1>c[u].pictures.length-1?o=0:o++,window.dispatchEvent(v.custom.modal.pointed)},decrease:function(){o-1<0?o=c[u].pictures.length-1:o--,window.dispatchEvent(v.custom.modal.pointed)}},k={gallery:function(t){return void 0!==t.getAttribute("data-kbox")?t.getAttribute("data-kbox"):"isolated"},position:function(){return{x:parseFloat((window.innerWidth-c[u].pictures[o].width)/2-10),y:parseFloat((window.innerHeight-c[u].pictures[o].height)/2-10)}}},v={custom:{modal:{contextualized:new Event("modal.contextualized"),pointed:new Event("modal.pointed"),opened:new Event("modal.opened"),transitioned:new Event("modal.transitioned"),closed:new Event("modal.closed"),exited:new Event("modal.exited")}},init:function(t){window.addEventListener("modal.contextualized",A),window.addEventListener("modal.pointed",C),window.addEventListener("modal.opened",b.afterOpening),window.addEventListener("modal.transitioned",b.afterTransition),window.addEventListener("modal.closed",b.afterClosing),window.addEventListener("modal.exited",y),b.keyboard&&v.keyboard(),v.opening(t),v.closing(),"ontouchstart"in document.documentElement?v.touch():v.navigation()},opening:function(t){t.forEach(function(t){t.addEventListener("click",w,!1)})},closing:function(){let t=document.querySelectorAll(".kbox-close--trigger");if(!t.length)return!1;t.forEach(function(t){t.addEventListener("click",y,!1)})},keyboard:function(){S.body.addEventListener("keyup",function(t){if(t.preventDefault(),!0===n){switch(t.keyCode){case 37:case 100:a.decrease();break;case 39:case 102:a.increase();break;case 27:window.dispatchEvent(v.custom.modal.exited)}}},!1)},navigation:function(){let t=document.querySelectorAll(".kbox-nav");if(!t.length)return!1;t.forEach(function(t){t.addEventListener("click",function(t){t.preventDefault(),"kbox-nav--prev"===t.target.id?a.decrease():a.increase()},!1)})},touch:function(){let t=0,d=0;S.modal.addEventListener("touchstart",function(n){n.changedTouches&&(t=n.changedTouches[0].screenX),d=n.changedTouches[0].screenY},!1),S.modal.addEventListener("touchend",function(d){d.changedTouches&&d.changedTouches[0].screenX+20>t+20?a.decrease():d.changedTouches&&d.changedTouches[0].screenX+20<t+20&&a.increase()},!1)}},S={body:null,overlay:null,modal:null,theme:null,quantities:null,alt:null,init:function(){S.body.appendChild(S.build.overlay()),S.body.appendChild(S.build.modal()),S.overlay=document.getElementById("kbox-overlay"),S.modal=document.getElementById("kbox-modal"),S.theme=document.getElementById("kbox-info--theme"),S.alt=document.getElementById("kbox-info--alt"),S.quantities=document.getElementById("kbox-info--quantities")},build:{overlay:function(){let t=document.createElement("div");return t.setAttribute("id","kbox-overlay"),t.setAttribute("class","kbox-close--trigger"),t},navigation:function(t){let n=document.createElement("div");n.setAttribute("id",t),n.setAttribute("class","kbox-nav"),b.titles&&n.setAttribute("title","kbox-nav--prev"===t?d.previous:d.next);let u=document.createElement("span");return u.setAttribute("class","kbox-nav--prev"===t?"hc hc-arrow-round-back":"hc hc-arrow-round-forward"),n.appendChild(u),n},modal:function(){let t=document.createElement("div");t.setAttribute("id","kbox-modal");let n=document.createElement("div");n.setAttribute("id","kbox-close"),n.setAttribute("class","kbox-close--trigger"),b.titles&&n.setAttribute("title",d.close);let u=document.createElement("i");u.setAttribute("class","hc hc-close"),n.appendChild(u);let c=new Image;c.setAttribute("id","kbox-image");let o=document.createElement("div");o.setAttribute("id","kbox-info");let h=document.createElement("div");h.setAttribute("id","kbox-info--context");let f=document.createElement("span");f.setAttribute("id","kbox-info--theme");let E=document.createElement("span");E.setAttribute("id","kbox-info--quantities");let w=document.createElement("div");w.setAttribute("id","kbox-info--alt"),h.appendChild(f),h.appendChild(E),o.appendChild(h),o.appendChild(w);let p=S.build.navigation("kbox-nav--prev"),A=S.build.navigation("kbox-nav--next");return t.appendChild(p),t.appendChild(c),t.appendChild(A),t.appendChild(o),t.appendChild(n),S.modal=t,t}}},i={init:async function(n){try{if(b=Object.assign(b,n),d=await T(b.lang),window.innerWidth<window.innerHeight&&(h.orientation=t.PORTRAIT),S.body=document.getElementsByTagName("body")[0],!S.body)return!1;let u=document.querySelectorAll(".kbox"),c=u.length;if(!u.length)return!1;for(let t=0;t<=c-1;t++)b.titles&&(u[t].title=d.display),E(u[t]);S.init(),v.init(u)}catch(t){alert(t.message)}}};return i};window.kbox=t().init}else console.log("Namespace kbox already exists !");
//# sourceMappingURL=kbox.min.js.map
